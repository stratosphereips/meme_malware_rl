from gym.envs.registration import register
from sklearn.model_selection import train_test_split

from malware_rl.envs.utils import interface

# create a holdout set
sha256 = interface.get_available_sha256()
sha256_train, sha256_holdout = train_test_split(sha256, test_size=0.3, random_state=26731)

MAXTURNS = 15

register(
    id="malconv-train-v0",
    entry_point="malware_rl.envs:MalConvEnv",
    kwargs={
        "random_sample": True,
        "maxturns": MAXTURNS,
        "sha256list": sha256_train,
        "save_modified_data": False
    },
)

register(
    id="malconv-test-v0",
    entry_point="malware_rl.envs:MalConvEnv",
    kwargs={
        "random_sample": False,
        "maxturns": MAXTURNS,
        "sha256list": sha256_holdout,
        "save_modified_data": True
    },
)

register(
    id="ember-train-v0",
    entry_point="malware_rl.envs:EmberEnv",
    kwargs={
        "random_sample": True,
        "maxturns": MAXTURNS,
        "sha256list": sha256_train,
        "save_modified_data": False
    },
)

register(
    id="ember-test-v0",
    entry_point="malware_rl.envs:EmberEnv",
    kwargs={
        "random_sample": False,
        "maxturns": MAXTURNS,
        "sha256list": sha256_holdout,
        "save_modified_data": False
    },
)

register(
    id="sorel-train-v0",
    entry_point="malware_rl.envs:SorelEnv",
    kwargs={
        "random_sample": True,
        "maxturns": MAXTURNS,
        "sha256list": sha256_train,
        "save_modified_data": False
    },
)

register(
    id="sorel-test-v0",
    entry_point="malware_rl.envs:SorelEnv",
    kwargs={
        "random_sample": False,
        "maxturns": MAXTURNS,
        "sha256list": sha256_holdout,
        "save_modified_data": True
    },
)
